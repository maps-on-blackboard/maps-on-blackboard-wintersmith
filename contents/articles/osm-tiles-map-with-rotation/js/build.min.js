!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require){function zoomTo(){var mercCenter,tiles,center=document.getElementById("center").value.split(","),zoom=parseInt(document.getElementById("zoom").value),rotation=parseFloat(document.getElementById("rotation").value);mercCenter=merc.forward([parseFloat(center[0]),parseFloat(center[1])]),tiles=tiler.getTiles(mercCenter,zoom,rotation),tilesContainerDiv.style.transform="rotate("+rotation+"deg)",tilesContainerDiv.innerHTML="",tiles.forEach(function(t){var img=document.createElement("img");img.src=baseURL+"/"+t.z+"/"+t.x+"/"+t.y+".png",img.setAttribute("style","left:"+t.left+"px;top:"+t.top+"px;"),img.setAttribute("class","tile"),tilesContainerDiv.appendChild(img)})}var tilesContainerDiv,size,merc,tiler,Tiler=require("map-the-tiles"),SphericalMercator=require("sphericalmercator"),baseURL="http://tile.openstreetmap.org";tilesContainerDiv=document.getElementById("tilesContainer"),size={height:parseInt(tilesContainerDiv.clientHeight),width:parseInt(tilesContainerDiv.clientWidth)},tiler=new Tiler(size),merc=new SphericalMercator({size:256}),document.getElementById("zoomTo").addEventListener("click",zoomTo),zoomTo()},{"map-the-tiles":2,sphericalmercator:7}],2:[function(require,module){function getBBox(points){var xArray=points.map(function(p){return p[0]}),yArray=points.map(function(p){return p[1]});return{left:Math.min.apply(this,xArray),right:Math.max.apply(this,xArray),bottom:Math.max.apply(this,yArray),top:Math.min.apply(this,yArray)}}var TransformMatrix=require("transformatrix"),intersect=require("rectangles-intersect"),MapTheTiles=function(viewportSize,projExtent,tileSize){this.vpSize=viewportSize||{width:256,height:256},this.projExtent=projExtent||{left:-20037508.342789244,right:20037508.342789244,bottom:-20037508.342789244,top:20037508.342789244},this.tSize=tileSize||256,this.maxRes=Math.min(Math.abs(this.projExtent.right-this.projExtent.left)/this.tSize,Math.abs(this.projExtent.top-this.projExtent.bottom)/this.tSize)};MapTheTiles.prototype.getTiles=function(ctr,z,rot){Array.isArray(ctr)||(ctr=[ctr.x,ctr.y]);var tr,rotViewportPx,xLeft,xRight,yBottom,yTop,top,left,vpExtPx=this._getExtentPx(ctr,z),ctrPx=this._pointToPx(ctr,z),expandedExtPx=vpExtPx,tiles=[];rot&&0!=rot&&(rot=-rot,tr=new TransformMatrix,tr.translate(ctrPx[0],ctrPx[1]),tr.rotate(Math.PI/180*rot),tr.translate(-ctrPx[0],-ctrPx[1]),rotViewportPx=[tr.transformPoint(vpExtPx.left,vpExtPx.bottom),tr.transformPoint(vpExtPx.right,vpExtPx.bottom),tr.transformPoint(vpExtPx.right,vpExtPx.top),tr.transformPoint(vpExtPx.left,vpExtPx.top)],expandedExtPx=getBBox(rotViewportPx)),xLeft=Math.floor(expandedExtPx.left/this.tSize),xRight=Math.floor(expandedExtPx.right/this.tSize),yBottom=Math.floor(expandedExtPx.bottom/this.tSize),yTop=Math.floor(expandedExtPx.top/this.tSize),top=topStart=Math.round(yTop*this.tSize-vpExtPx.top),left=Math.round(xLeft*this.tSize-vpExtPx.left);for(var i=xLeft;xRight>=i;i++){top=topStart;for(var j=yTop;yBottom>=j;j++)tiles.push({x:i,y:j,z:z,top:top,left:left}),top+=this.tSize;left+=this.tSize}return rot&&0!=rot&&(tiles=tiles.filter(function(t){return intersect(rotViewportPx,this._getTileBoundingRect(t))},this)),tiles},MapTheTiles.prototype._getExtentPx=function(ctr,z){var res=this.maxRes/Math.pow(2,z);return{left:(ctr[0]-this.projExtent.left)/res-this.vpSize.width/2,right:(ctr[0]-this.projExtent.left)/res+this.vpSize.width/2,bottom:(this.projExtent.top-ctr[1])/res+this.vpSize.height/2,top:(this.projExtent.top-ctr[1])/res-this.vpSize.height/2}},MapTheTiles.prototype._pointToPx=function(pt,z){var res=this.maxRes/Math.pow(2,z);return[(pt[0]-this.projExtent.left)/res,(this.projExtent.top-pt[1])/res]},MapTheTiles.prototype._getTileBoundingRect=function(t){var res,l,r,t,b;return res=this.maxRes/Math.pow(2,t.z),l=t.x*this.tSize,r=l+this.tSize,t=t.y*this.tSize,b=t+this.tSize,[[l,b],[r,b],[r,t],[l,t]]},module.exports=MapTheTiles},{"rectangles-intersect":5,transformatrix:6}],3:[function(require,module){function pointInRect(pt,rect,precision){var p=precision||6,rectArea=.5*Math.abs((rect[0][1]-rect[2][1])*(rect[3][0]-rect[1][0])+(rect[1][1]-rect[3][1])*(rect[0][0]-rect[2][0])),triangleArea=rect.reduce(function(prev,cur,i,arr){var j=i==arr.length-1?0:i+1;return prev+.5*Math.abs(pt[0]*(arr[i][1]-arr[j][1])+arr[i][0]*(arr[j][1]-pt[1])+arr[j][0]*(pt[1]-arr[i][1]))},0);return fix(triangleArea,p)==fix(rectArea,p)}function fix(n,p){return parseInt(n*Math.pow(10,p))}module.exports=pointInRect},{}],4:[function(require,module){function linesIntersect(seg1,seg2,precision){var x,y,x1=seg1[0][0],y1=seg1[0][1],x2=seg1[1][0],y2=seg1[1][1],x3=seg2[0][0],y3=seg2[0][1],x4=seg2[1][0],y4=seg2[1][1],result=!1,p=precision||6,denominator=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);return 0==denominator?fix((y3-y1)*(x2-x1),p)==fix((y2-y1)*(x3-x1),p)&&(result=intPtOnSegment(x3,y3,x1,y1,x2,y2,p)||intPtOnSegment(x4,y4,x1,y1,x2,y2,p)):(x=((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4))/denominator,y=((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4))/denominator,result=intPtOnSegment(x,y,x1,y1,x2,y2,p)&&intPtOnSegment(x,y,x3,y3,x4,y4,p)),result}function intPtOnSegment(x,y,x1,y1,x2,y2,p){return fix(Math.min(x1,x2),p)<=fix(x,p)&&fix(x,p)<=fix(Math.max(x1,x2),p)&&fix(Math.min(y1,y2),p)<=fix(y,p)&&fix(y,p)<=fix(Math.max(y1,y2),p)}function fix(n,p){return parseInt(n*Math.pow(10,p))}module.exports=linesIntersect},{}],5:[function(require,module){function intersects(rect1,rect2){var intersect=rect1.some(function(pt1,i,r1){var j=i==r1.length-1?0:i+1;return rect2.some(function(pt2,k,r2){var l=k==r2.length-1?0:k+1;return linesIntersect([r1[i],r1[j]],[r2[k],r2[l]])})});return intersect||(intersect=rect2.some(function(pt){return pointInside(pt,rect1)})||rect1.some(function(pt){return pointInside(pt,rect2)})),intersect}var linesIntersect=require("line-segments-intersect"),pointInside=require("check-point-in-rectangle");module.exports=intersects},{"check-point-in-rectangle":3,"line-segments-intersect":4}],6:[function(require,module){var Matrix=function(){this.reset()};Matrix.prototype.reset=function(){return this.m=[1,0,0,1,0,0],this},Matrix.prototype.multiply=function(matrix){var m11=this.m[0]*matrix.m[0]+this.m[2]*matrix.m[1],m12=this.m[1]*matrix.m[0]+this.m[3]*matrix.m[1],m21=this.m[0]*matrix.m[2]+this.m[2]*matrix.m[3],m22=this.m[1]*matrix.m[2]+this.m[3]*matrix.m[3],dx=this.m[0]*matrix.m[4]+this.m[2]*matrix.m[5]+this.m[4],dy=this.m[1]*matrix.m[4]+this.m[3]*matrix.m[5]+this.m[5];return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this.m[4]=dx,this.m[5]=dy,this},Matrix.prototype.inverse=function(){var inv=new Matrix;inv.m=this.m.slice(0);var d=1/(inv.m[0]*inv.m[3]-inv.m[1]*inv.m[2]),m0=inv.m[3]*d,m1=-inv.m[1]*d,m2=-inv.m[2]*d,m3=inv.m[0]*d,m4=d*(inv.m[2]*inv.m[5]-inv.m[3]*inv.m[4]),m5=d*(inv.m[1]*inv.m[4]-inv.m[0]*inv.m[5]);return inv.m[0]=m0,inv.m[1]=m1,inv.m[2]=m2,inv.m[3]=m3,inv.m[4]=m4,inv.m[5]=m5,inv},Matrix.prototype.rotate=function(rad){var c=Math.cos(rad),s=Math.sin(rad),m11=this.m[0]*c+this.m[2]*s,m12=this.m[1]*c+this.m[3]*s,m21=this.m[0]*-s+this.m[2]*c,m22=this.m[1]*-s+this.m[3]*c;return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this},Matrix.prototype.translate=function(x,y){return this.m[4]+=this.m[0]*x+this.m[2]*y,this.m[5]+=this.m[1]*x+this.m[3]*y,this},Matrix.prototype.scale=function(sx,sy){return this.m[0]*=sx,this.m[1]*=sx,this.m[2]*=sy,this.m[3]*=sy,this},Matrix.prototype.transformPoint=function(px,py){var x=px,y=py;return px=x*this.m[0]+y*this.m[2]+this.m[4],py=x*this.m[1]+y*this.m[3]+this.m[5],[px,py]},Matrix.prototype.transformVector=function(px,py){var x=px,y=py;return px=x*this.m[0]+y*this.m[2],py=x*this.m[1]+y*this.m[3],[px,py]},"undefined"!=typeof module?module.exports=Matrix:window.Matrix=Matrix},{}],7:[function(require,module,exports){var SphericalMercator=function(){function SphericalMercator(options){if(options=options||{},this.size=options.size||256,!cache[this.size]){var size=this.size,c=cache[this.size]={};c.Bc=[],c.Cc=[],c.zc=[],c.Ac=[];for(var d=0;30>d;d++)c.Bc.push(size/360),c.Cc.push(size/(2*Math.PI)),c.zc.push(size/2),c.Ac.push(size),size*=2}this.Bc=cache[this.size].Bc,this.Cc=cache[this.size].Cc,this.zc=cache[this.size].zc,this.Ac=cache[this.size].Ac}var cache={},D2R=Math.PI/180,R2D=180/Math.PI,A=6378137,MAXEXTENT=20037508.342789244;return SphericalMercator.prototype.px=function(ll,zoom){var d=this.zc[zoom],f=Math.min(Math.max(Math.sin(D2R*ll[1]),-.9999),.9999),x=Math.round(d+ll[0]*this.Bc[zoom]),y=Math.round(d+.5*Math.log((1+f)/(1-f))*-this.Cc[zoom]);return x>this.Ac[zoom]&&(x=this.Ac[zoom]),y>this.Ac[zoom]&&(y=this.Ac[zoom]),[x,y]},SphericalMercator.prototype.ll=function(px,zoom){var g=(px[1]-this.zc[zoom])/-this.Cc[zoom],lon=(px[0]-this.zc[zoom])/this.Bc[zoom],lat=R2D*(2*Math.atan(Math.exp(g))-.5*Math.PI);return[lon,lat]},SphericalMercator.prototype.bbox=function(x,y,zoom,tms_style,srs){tms_style&&(y=Math.pow(2,zoom)-1-y);var ll=[x*this.size,(+y+1)*this.size],ur=[(+x+1)*this.size,y*this.size],bbox=this.ll(ll,zoom).concat(this.ll(ur,zoom));return"900913"===srs?this.convert(bbox,"900913"):bbox},SphericalMercator.prototype.xyz=function(bbox,zoom,tms_style,srs){"900913"===srs&&(bbox=this.convert(bbox,"WGS84"));var ll=[bbox[0],bbox[1]],ur=[bbox[2],bbox[3]],px_ll=this.px(ll,zoom),px_ur=this.px(ur,zoom),bounds={minX:Math.floor(px_ll[0]/this.size),minY:Math.floor(px_ur[1]/this.size),maxX:Math.floor((px_ur[0]-1)/this.size),maxY:Math.floor((px_ll[1]-1)/this.size)};if(tms_style){var tms={minY:Math.pow(2,zoom)-1-bounds.maxY,maxY:Math.pow(2,zoom)-1-bounds.minY};bounds.minY=tms.minY,bounds.maxY=tms.maxY}return bounds},SphericalMercator.prototype.convert=function(bbox,to){return"900913"===to?this.forward(bbox.slice(0,2)).concat(this.forward(bbox.slice(2,4))):this.inverse(bbox.slice(0,2)).concat(this.inverse(bbox.slice(2,4)))},SphericalMercator.prototype.forward=function(ll){var xy=[A*ll[0]*D2R,A*Math.log(Math.tan(.25*Math.PI+.5*ll[1]*D2R))];return xy[0]>MAXEXTENT&&(xy[0]=MAXEXTENT),xy[0]<-MAXEXTENT&&(xy[0]=-MAXEXTENT),xy[1]>MAXEXTENT&&(xy[1]=MAXEXTENT),xy[1]<-MAXEXTENT&&(xy[1]=-MAXEXTENT),xy},SphericalMercator.prototype.inverse=function(xy){return[xy[0]*R2D/A,(.5*Math.PI-2*Math.atan(Math.exp(-xy[1]/A)))*R2D]},SphericalMercator}();"undefined"!=typeof module&&"undefined"!=typeof exports&&(module.exports=exports=SphericalMercator)},{}]},{},[1]);